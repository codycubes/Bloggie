/*! error.js runtime Built 26-03-2014 
 * License: MIT 
 * Homepage: https://github.com/kcauchy/error.js 
 */
!function(){function a(a,b){var d=b.name;"string"!=typeof d||c(d)||"undefined"!=typeof b.code||(b.code=d)}function b(a,b){b.errno=a}function c(a){return!a||/^\s*$/.test(a)}function d(a,b,c,d){var f={},h=!1,j=g.getFullPackageName(a,d);return(h=g.validateKeywords(f,c))&&(e.registerPackage(f,j,g),g[b]=f,i[j]=f),h}var e=require("register-js"),f=Error,g=function(a,b,c,d){var e=g.prototype.initializeMessageString.apply(this,arguments),h=f.call(this,e.message);h.constructor=f,h.extra="object"==typeof arguments[2]?c:void 0,h.previous="object"==typeof arguments[3]?d:void 0;for(var i in e)h[i]=e[i];return h};g.prototype.initializeMessageString=function(a,b){var c=typeof a,d={};d="number"===c?g[a]:"string"===c?a.match(/\\w[\\w\\._0-9]*/g)?g.getError(a):{desc:a}:a,d||(d={desc:a});for(var e in d)g.handleKeywords(e,d);var f=[];if("array"==typeof b||"object"==typeof b){for(var h in b)f[h]=b[h];f.unshift(d.desc)}else{arguments.length>0&&Array.prototype.shift.call(arguments),f.push(d.desc);for(var i,j=0;j<arguments.length;j++)i=Array.prototype.shift.call(arguments),i&&f.push(i)}return d.message=g.stringFormatter.apply(this,f),d},String.prototype.format||(String.prototype.format=function(){if(arguments.length<=1)return this;var a=arguments;return this.replace(/{(\d+)}/g,function(b,c){return"undefined"!=typeof a[c]?a[c]:b})}),String.format||(String.format=function(a){if(arguments.length<=1)return a;var b=Array.prototype.slice.call(arguments,1);return a.replace(/{(\d+)}/g,function(a,c){return"undefined"!=typeof b[c]?b[c]:a})}),g.stringFormatter=String.format,g.setStringFormatter=function(a){g.stringFormatter=a},g.getStringFormatter=function(){return g.stringFormatter};var h=!0;"object"==typeof window&&(h=!1);var i=[],j={},k={},l=[],m=[/^error$/i];g.addKeywordHandler=function(a,b){j[a]=b},g.removeKeywordHandler=function(a){delete j[a]},g.handleKeywords=function(a,b){"function"==typeof j[a]&&j[a](b[a],b)},g.addKeywordHandler("name",a),g.addKeywordHandler("id",b),"undefined"==typeof Array.prototype.remove&&(Array.prototype.remove=function(a,b){var c=Array.prototype.slice.call(this,(b||a)+1||this.length);return this.length=0>a?this.length+a:a,Array.prototype.push.apply(this,c)}),g.register=function(a,b){if(arguments.length>2)return g.registerOne(arguments[0],arguments[1],arguments[2],arguments[3]);if("object"!=typeof a)throw new Error("Registered error should be an object");var c=!0;if("name"in a&&"id"in a)d(a.name,a.id,a,b);else for(var e in a){var f=a[e];c&=g.registerOne(e,f.id,f.desc,f,b)}return c},g.addIgnoranceRules=function(a){if("object"==typeof a&&a.constructor!=RegExp||"array"==typeof a)for(var b in a)m.push(a[b]);else m.push(a)},g.getIgnoranceRules=function(){return m},g.getIgnoranceRuleCount=function(){return m.length},g.clearIgnoranceRules=function(){m=[]},g.removeIgnoranceRule=function(a){for(var b=0;b<m.length;b++)m[b]===a&&m.remove(b)},g.restoreIgnoranceRules=function(){m=[/error/i]};var n=function(a){if(c(a))return!0;for(var b=0;b<m.length;b++)if(a.match(m[b]))return!0;return!1};g.getFullPackageName=function(a,b){if("undefined"==typeof b||c(b))return a;if(b in l)return l[b]+a;for(var d=b.split(/[.\/]/g),e=d.length,f="",g=0;e>g;g++){var h=d.shift();n(h)||(f+=h+".")}return l[b]=f,f+a},g.clearPackageNameCache=function(){l=[]},g.registerOne=function(a,b,c,e,f){var h=g.getFullPackageName(a,f);return"undefined"==typeof e&&(e={name:h,id:b,desc:c}),d(h,b,e)},g.getError=function(a){return"string"==typeof a?e.getPackage(a,g):g[a]},g.addKeywordValidator=function(a,b){k[a]=b},g.validateKeywords=function(a,b){var c=!0;for(var d in b)if(d in k){var e=b[d];c&=k[d](e,a,b,d)}return c};var o=function(a,b){var c=e.getPackage(a,g);if(c)throw new Error('The package "'+a+'" has already been used.');switch(a){case"name":case"id":case"desc":case"lang":throw new Error('Error name "'+a+'" is reserved.');default:if("function"==typeof g[a])throw new Error('Error name "'+a+'" has been taken from service functions.')}return b.name=a,!0},p=function(a,b){if("number"!=typeof a)throw new Error("Id should be a number");var c=g[a];if(c)throw new Error('The id "'+a+'" has already been used.');return b.id=a,!0},q=function(a,b){return"object"==typeof a?b.lang=a:b.desc=a,!0},r=function(a,b){return b.code=a,!0},s=function(a,b){return b.errno=a,!0};g.addKeywordValidator("name",o),g.addKeywordValidator("id",p),g.addKeywordValidator("desc",q),g.addKeywordValidator("code",r),g.addKeywordValidator("errno",s),g.setFileType=function(a){"string"!=typeof a&&(requireJSON.fileType="json"),requireJSON.fileType=a},g.getFileType=function(){return requireJSON.fileType},g.clearAllError=function(){var a=0;for(var b in i){var c=g.removeError(i[b]);c&&a++}return a},g.removeError=function(a){var b=typeof a,c=!1;switch(b){case"object":c=a.name;break;case"string":c=a;break;case"number":c=g[a]}if(!c)return!1;var d=null;return(d=e.getPackage(c,g))?(e.removePackage(d.name,g),delete g[d.id],delete i[d.name],!0):!1},g.getErrors=function(){return i},g.getErrorCount=function(){return i.length},g.require=function(a,b){var c=requireJSON(a,b),d=a;return"string"==typeof b&&(d=b),g.register(c,d)},g.pack=function(a,b){var c=requireJSON(a,b),d=a;"string"==typeof b&&(d=b);var e="register("+JSON.stringify(c)+', "requireJSON.cacheSymbol.'+g.getFullPackageName(d)+'", module);';return e},e(g,"error",module),h?GLOBAL.Exception=g:window.Exception=g,Error=g,g.noConflict=function(){return Error=f,g},e(g,"error-js",module)}();